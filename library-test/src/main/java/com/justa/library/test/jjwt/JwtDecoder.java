package com.justa.library.test.jjwt;

import java.util.Base64;

// from https://stackoverflow.com/questions/35791465/is-there-a-way-to-parse-claims-from-an-expired-jwt-token
public class JwtDecoder {

	public static void decode (String jwtToken){
		Base64.Decoder decoder = Base64.getUrlDecoder();
		
		String[] parts = jwtToken.split("\\."); // Splitting header, payload and signature
		System.out.println("Headers: "+new String(decoder.decode(parts[0]))); // Header
		System.out.println("Payload: "+new String(decoder.decode(parts[1]))); // Payload
	}
	
	public static void main(String[] args) throws Exception {
		
		String jwtToken = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCIsImV4cCI6IjEzMDA4MTkzODAifQ.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiYWRtaW4iOnRydWV9.2GpoV9q_uguSg0Ku6peI5aZ2qBxO5qOA42zaS25gq_c";
		decode(jwtToken);
		System.out.println(); 
		
		jwtToken = "eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI4VVhKcFNZcThJNF96aUhYX0xxVnUzOTNnQ3NYUUZqLUp3MDNvN3VYako0In0.eyJqdGkiOiJmYjllOWY5Yi0wM2Y2LTRkNTItOGUxYS0zOGI5MGJlYjI3NDMiLCJleHAiOjE1Nzg1MjA5NTcsIm5iZiI6MCwiaWF0IjoxNTc4NTA2NTU3LCJpc3MiOiJodHRwczovL2lkcDAyLnZhbGlkdXNob2xkaW5ncy5jb206ODQ0My9hdXRoL3JlYWxtcy92Y2Fwcy10ZXN0IiwiYXVkIjoidmNhcHMtcWEtODA4NiIsInN1YiI6ImI3MTdhMDEzLTU0MDYtNDZjZC04YmU2LTkxYmI1YTU3Y2U5MyIsInR5cCI6IkJlYXJlciIsImF6cCI6InZjYXBzLXFhLTgwODYiLCJhdXRoX3RpbWUiOjE1Nzg0OTE5NzgsInNlc3Npb25fc3RhdGUiOiI3MDg1NzA3Ni1mODAwLTRhMjItYTBkNi05OTQ1Yjg5YmVhNDAiLCJhY3IiOiIwIiwiYWxsb3dlZC1vcmlnaW5zIjpbIioiXSwicmVhbG1fYWNjZXNzIjp7InJvbGVzIjpbInZjYXBzLWFkbWluIiwib2ZmbGluZV9hY2Nlc3MiLCJ1bWFfYXV0aG9yaXphdGlvbiJdfSwicmVzb3VyY2VfYWNjZXNzIjp7ImFjY291bnQiOnsicm9sZXMiOlsibWFuYWdlLWFjY291bnQiLCJtYW5hZ2UtYWNjb3VudC1saW5rcyIsInZpZXctcHJvZmlsZSJdfX0sImF1dGhvcml6YXRpb24iOnsicGVybWlzc2lvbnMiOlt7InJzaWQiOiI4YmQwZWIwYi1lZWNkLTRiYTgtOGQ1Yy01YzVkNmIwYmJkZmYiLCJyc25hbWUiOiJEZWZhdWx0IFJlc291cmNlIn1dfSwic2NvcGUiOiJvcGVuaWQgcHJvZmlsZSBlbWFpbCIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwicHJlZmVycmVkX3VzZXJuYW1lIjoianVzdGluLnd1IiwiZW1haWwiOiJqdXN0aW4ud3VAZ2xvYmFsLmxvY2FsIn0.j9leDHohvkQL0JDoVEO0zU_MMtFAqPlUcTfnq6XfXIHu7YlcbiHIpclHqEFHm08J0VAw2t58hPhmqJZ9Q4pWpgKUyM-okXlK5mw4Phez25Yamo0Ztko9agACvVCbhd6c7fBW5ysKbLrgMDOtX_2QoVg0MGF9eRATG1KUpD0fHeukyM50-zLz1RQXRAK77WsQsyLf4GeBDg_evD71D1LdmbA5RYIEBPc7Kng_Xh0JpEnVs30a6x-8pPIEgp3zFtfsl-ZAB_igJoKSoB7RLp2dDi1rifU0rGwQVn94PbkYiRXoaKvJJlthuJ-KHLszkMxiMM5D-YLJKGiMgXdwSiXh5Q";
		decode(jwtToken);
		
	}
}
